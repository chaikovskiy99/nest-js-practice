on: 
  push:
      branches:
      - migration
name: ðŸš€ Deploy website on push
jobs:
 web-deploy:
  name: ðŸŽ‰ Deploy
  runs-on: ubuntu-latest
  steps:
  - name: ðŸšš Get latest code
    uses: actions/checkout@v3
  - name: Use Node.js 20
    uses: actions/setup-node@v2
    with:
      node-version: '20'
  - name: ðŸ”¨ Build Project
    run: |
      npm install
      npm run build
      cp package.json dist/
      
  - name: ðŸ“‚ Sync files to server
    uses: SamKirkland/FTP-Deploy-Action@4.3.3
    with:
      server: ${{ secrets.SERVER }}
      username: ${{ secrets.USER_NAME }}
      password: ${{ secrets.PASSWORD }}
      log-level : verbose
      security: loose
      timeout: 95000
      port: 21
      local-dir: dist/
      server-dir: /
      exclude: |
        **/.git*
        **/src/**
        **/.git*/**
        **/node_modules/**
        fileToExclude.txt
      